stages:
  get_raw_data:
    cmd: >-
      gsutil -m cp gs://medscript-mimic4-dataset/raw_data/* 
      data-pipeline/data/raw/
    deps:
      - ../secrets/medscript-sa.json
    outs:
      - data-pipeline/data/raw

  preprocess:
    cmd: >-
      python data-pipeline/src/preprocessing/preprocess_dataset.py 
      --input data-pipeline/data/raw 
      --output data-pipeline/data/processed
    deps:
      - data-pipeline/src/preprocessing/preprocess_dataset.py
      - data-pipeline/data/raw
    outs:
      - data-pipeline/data/processed

  create_embeddings:
    cmd: >-
      python data-pipeline/src/preprocessing/create_embedding.py 
      --input data-pipeline/data/processed/preprocessed_dataset.csv 
      --output data-pipeline/data/embeddings
    deps:
      - data-pipeline/src/preprocessing/create_embedding.py
      - data-pipeline/data/processed/preprocessed_dataset.csv
    outs:
      - data-pipeline/data/embeddings